<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cari Data Customer</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 min-h-screen p-6 text-slate-100 flex flex-col items-center">
    
    <div class="max-w-xl w-full">
        <div class="bg-slate-800 border border-slate-700 rounded-3xl shadow-2xl p-6 mb-6">
            <h2 class="text-2xl font-bold text-purple-400 mb-4 text-center">PENCARIAN DATA</h2>
            <div class="flex gap-2">
                <input type="text" id="userInput" placeholder="Ketik nama (contoh: sun)..." 
                       class="w-full bg-slate-700 border-none rounded-xl p-4 focus:ring-2 focus:ring-purple-500 text-white">
                <button onclick="cari()" class="bg-purple-600 hover:bg-purple-500 px-6 rounded-xl font-bold transition-all">CARI</button>
            </div>
            <div id="statusInfo" class="mt-2 text-sm text-slate-400 text-center"></div>
        </div>

        <div id="resultsContainer" class="space-y-4"></div>
    </div>

    <script>
        async function cari() {
            const kueri = document.getElementById('userInput').value;
            const container = document.getElementById('resultsContainer');
            const info = document.getElementById('statusInfo');
            const url = 'https://script.google.com/macros/s/AKfycbz7TAAnHQXjqeuiY4rudNRh_9fQzMc8B3XhvdfdNLvMP900L6WVDBSu1nRnEwhBvwr4/exec'; // Ganti dengan URL deployment baru

            if(!kueri) return alert("Masukkan kata kunci!");

            container.innerHTML = "";
            info.innerText = "â³ Mencari data...";

            try {
                const res = await fetch(`${url}?id=${encodeURIComponent(kueri)}`);
                const result = await res.json();

                if (result.status === "success") {
                    info.innerText = `Ditemukan ${result.data.length} data.`;
                    
                    result.data.forEach(item => {
                        let rawHp = item.noHp.toString().replace(/\D/g, '');
                        if (rawHp.startsWith('0')) rawHp = '62' + rawHp.slice(1);

                        const card = `
                            <div class="bg-slate-800 border border-slate-700 rounded-2xl p-5 shadow-lg animate-fade-in">
                                <div class="flex justify-between items-start mb-3">
                                    <div>
                                        <h3 class="text-lg font-bold text-purple-300">${item.nama}</h3>
                                        <p class="text-xs text-slate-500">${item.idCst || '-'}</p>
                                    </div>
                                    <span class="bg-slate-700 text-purple-400 text-[10px] px-2 py-1 rounded-full font-bold uppercase">${item.paket}</span>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-2 text-sm mb-4">
                                    <div class="text-slate-400 font-medium">Jatuh Tempo: <span class="text-red-400">${item.japo}</span></div>
                                    <div class="text-slate-400 font-medium text-right">Email: <span class="text-slate-200 text-xs">${item.email || '-'}</span></div>
                                </div>

                                <a href="https://wa.me/${rawHp}" target="_blank" 
                                   class="block w-full text-center bg-green-600 hover:bg-green-500 text-white py-2 rounded-xl font-bold text-sm transition-all">
                                    HUBUNGI WHATSAPP
                                </a>
                            </div>
                        `;
                        container.innerHTML += card;
                    });
                } else {
                    info.innerText = "";
                    alert("Data tidak ditemukan!");
                }
            } catch (e) { 
                info.innerText = "";
                alert("Kesalahan koneksi!"); 
            }
        }
    </script>
</body>
</html>
