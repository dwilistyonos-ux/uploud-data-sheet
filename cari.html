<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cari Data Pelanggan</title>
  <style>
    body { font-family: sans-serif; background-color: #4c1d95; display: flex; justify-content: center; padding: 20px; }
    .card { background: white; padding: 25px; border-radius: 15px; width: 100%; max-width: 450px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
    h2 { text-align: center; color: #7f00ff; }
    input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
    button { width: 100%; padding: 12px; background: #7f00ff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
    #resultCard { margin-top: 20px; display: none; border-top: 2px solid #eee; padding-top: 15px; }
    .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f9f9f9; font-size: 14px; }
    .val { font-weight: bold; text-align: right; }
    .wa-btn { display: block; text-align: center; margin-top: 15px; color: #25D366; text-decoration: none; font-weight: bold; border: 2px solid #25D366; padding: 10px; border-radius: 8px; }
  </style>
</head>
<body>

<div class="card">
  <h2>Cari Data CST / Nama</h2>
  <input type="text" id="userInput" placeholder="Masukkan Nama atau ID CST...">
  <button onclick="cari()">CARI SEKARANG</button>
  
  <div id="loader" style="display:none; text-align:center; margin-top:10px;">Mencari...</div>

  <div id="resultCard">
    <div class="row"><span>Nama:</span> <span class="val" id="resNama"></span></div>
    <div class="row"><span>ID CST:</span> <span class="val" id="resId"></span></div>
    <div class="row"><span>Tgl Pasang:</span> <span class="val" id="resTgl"></span></div>
    <div class="row"><span>JAPO:</span> <span class="val" id="resJapo"></span></div>
    <div class="row"><span>Paket:</span> <span class="val" id="resPaket"></span></div>
    <div class="row"><span>Alamat:</span> <span class="val" id="resAlamat"></span></div>
    <div class="row"><span>No. HP:</span> <span class="val" id="resHp"></span></div>
    <a id="waLink" href="#" target="_blank" class="wa-btn">HUBUNGI WA ðŸ“±</a>
  </div>
</div>

<script>
  async function cari() {
    const kueri = document.getElementById('userInput').value;
    if(!kueri) return alert("Masukkan Nama atau ID!");

    // GANTI DENGAN URL WEB APP ANDA YANG BARU
    const url = "https://script.google.com/macros/s/AKfycbyMl8Dj4cKLTGtq36oBhg8NLZC3QFkTShH0DyIBJsQ9BpFL2NGhj6GLmoLA7K5bFo77/exec";

    document.getElementById('loader').style.display = "block";
    document.getElementById('resultCard').style.display = "none";

    try {
      const response = await fetch(`${url}?id=${encodeURIComponent(kueri)}`);
      const data = await response.json();
      document.getElementById('loader').style.display = "none";

      if (data.status === "success") {
        document.getElementById('resNama').innerText = data.nama;
        document.getElementById('resId').innerText = data.idCst;
        document.getElementById('resTgl').innerText = data.tanggal;
        document.getElementById('resJapo').innerText = data.japo;
        document.getElementById('resPaket').innerText = data.paket;
        document.getElementById('resAlamat').innerText = data.alamat;
        document.getElementById('resHp').innerText = data.noHp;

        let num = data.noHp.toString().replace(/\D/g, '');
        if (!num.startsWith('62')) num = '62' + num.replace(/^0/, '');
        document.getElementById('waLink').href = `https://wa.me/${num}`;

        document.getElementById('resultCard').style.display = "block";
      } else {
        alert("Data tidak ditemukan!");
      }
    } catch (e) {
      document.getElementById('loader').style.display = "none";
      alert("Error koneksi!");
    }
  }
</script>
</body>
</html>
