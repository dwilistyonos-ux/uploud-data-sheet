<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; font-weight: bold; margin-bottom: 5px; }
    input, select { width: 100%; padding: 8px; box-sizing: border-box; }
    button { padding: 10px 20px; background-color: #28a745; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>

<form id="myForm">
  <div class="form-group">
    <label>Nama Pelanggan</label>
    <input type="text" name="Nama" required>
  </div>

  <div class="form-group">
    <label>Paket</label>
    <select name="Paket" id="paketSelect" required>
      </select>
  </div>

  <div class="form-group">
    <label>Point</label>
    <select name="Point" required>
      <option value="0.25">0.25</option>
      <option value="1">1</option>
      <option value="2">2</option>
    </select>
  </div>

  <div class="form-group">
    <label>Bonus</label>
    <select name="Bonus" id="bonusSelect" required>
      </select>
  </div>

  <div class="form-group"><label>Billing</label><input type="text" name="Billing"></div>
  <div class="form-group"><label>No HP</label><input type="text" name="No_HP"></div>
  <div class="form-group"><label>ID CST</label><input type="text" name="ID_CST"></div>

  <button type="submit" id="submitBtn">Simpan Data</button>
</form>

<script>
  // Mengisi Dropdown Paket secara otomatis (10 - 500 Mbps)
  const paketSelect = document.getElementById('paketSelect');
  const mbpsOptions = [10, 15, 20, 30, 40, 50, 75, 100, 150, 200, 300, 500];
  mbpsOptions.forEach(val => {
    let opt = document.createElement('option');
    opt.value = val + "Mbps";
    opt.innerHTML = val + " Mbps";
    paketSelect.appendChild(opt);
  });

  // Mengisi Dropdown Bonus secara otomatis
  const bonusSelect = document.getElementById('bonusSelect');
  const bonusOptions = [25000, 50000, 100000, 150000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000];
  bonusOptions.forEach(val => {
    let opt = document.createElement('option');
    opt.value = val;
    opt.innerHTML = "Rp " + val.toLocaleString('id-ID');
    bonusSelect.appendChild(opt);
  });

  // Handle Submit Form ke Google Apps Script
  document.getElementById('myForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    btn.disabled = true;
    btn.innerHTML = "Menyimpan...";

    const formData = new FormData(this);
    const queryString = new URLSearchParams(formData).toString();
    const webAppUrl = "https://script.google.com/macros/s/AKfycbwW9A1X1ztE61msd1JPtAeTGkC3o8wpRykMkYfBEk0tF3vrIU1sswFV9kGqmIwsZGff/exec"; // Ganti dengan URL Deployment Anda

    fetch(webAppUrl, {
      method: 'POST',
      mode: 'no-cors', // Penting untuk Apps Script
      body: formData
    })
    .then(() => {
      alert("Data berhasil dikirim!");
      this.reset();
      btn.disabled = false;
      btn.innerHTML = "Simpan Data";
    })
    .catch(err => alert("Terjadi kesalahan: " + err));
  });
</script>

</body>
</html>
