<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Rekapan MyRepublic</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --bg: #f0f3f7;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; }
        .container { background: #fff; padding: 30px; border-radius: 20px; box-shadow: 10px 10px 20px #bebebe, -10px -10px 20px #ffffff; width: 100%; max-width: 500px; }
        h2 { text-align: center; color: #444; text-transform: uppercase; letter-spacing: 2px; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #666; }
        
        /* Efek 3D Input */
        input, select, textarea {
            width: 100%; padding: 12px; border: none; border-radius: 8px;
            background: #f0f3f7;
            box-shadow: inset 4px 4px 8px #d1d9e6, inset -4px -4px 8px #ffffff;
            box-sizing: border-box; transition: 0.3s;
        }
        input:focus { outline: none; box-shadow: inset 2px 2px 4px #d1d9e6, inset -2px -2px 4px #ffffff; }

        .btn-container { display: flex; gap: 10px; margin-top: 20px; }
        button {
            flex: 1; padding: 15px; border: none; border-radius: 10px; cursor: pointer;
            font-weight: bold; text-transform: uppercase; transition: 0.2s;
        }
        .btn-submit { background: #6c5ce7; color: white; box-shadow: 4px 4px 8px #cbcbcb, -4px -4px 8px #ffffff; }
        .btn-submit:active { box-shadow: inset 4px 4px 8px #5649b8, inset -4px -4px 8px #8275ff; }
        
        .btn-search { background: #00b894; color: white; box-shadow: 4px 4px 8px #cbcbcb, -4px -4px 8px #ffffff; }

        /* Notification */
        #notif { display: none; padding: 15px; background: #55efc4; color: #006266; border-radius: 8px; text-align: center; margin-bottom: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>Input Data Sales</h2>
    <div id="notif">Data Berhasil Terkirim! âœ…</div>
    
    <form id="salesForm">
        <div class="form-group">
            <label>Billing</label>
            <input type="text" name="billing" required>
        </div>
        <div class="form-group">
            <label>Tanggal</label>
            <input type="date" name="tanggal" required>
        </div>
        <div class="form-group">
            <label>JAPO</label>
            <input type="text" name="japo">
        </div>
        <div class="form-group">
            <label>Nama Pelanggan</label>
            <input type="text" name="nama" required>
        </div>
        <div class="form-group">
            <label>ID CST</label>
            <input type="text" name="id_cst" required>
        </div>
        <div class="form-group">
            <label>Nomor HP (Tanpa 0/62)</label>
            <input type="number" name="hp" placeholder="8123456xxx" required>
        </div>
        <div class="form-group">
            <label>Alamat</label>
            <textarea name="alamat" rows="2"></textarea>
        </div>
        <div class="form-group">
            <label>Paket</label>
            <select name="paket" id="paketSelect"></select>
        </div>
        <div class="form-group">
            <label>Point</label>
            <select name="point">
                <option value="0.25">0.25</option>
                <option value="1">1</option>
                <option value="2">2</option>
            </select>
        </div>
        <div class="form-group">
            <label>Bonus</label>
            <select name="bonus" id="bonusSelect"></select>
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email">
        </div>

        <div class="btn-container">
            <button type="submit" class="btn-submit">Kirim Data</button>
            <button type="button" class="btn-search" onclick="alert('Fitur pencarian terhubung ke database spreadsheet')">Cari Data</button>
        </div>
    </form>
</div>

<script>
    // Isi otomatis dropdown Paket 10Mbps - 500Mbps
    const paketArr = ["10Mbps", "15Mbps", "30Mbps", "50Mbps", "100Mbps", "250Mbps", "500Mbps"];
    const pSelect = document.getElementById('paketSelect');
    paketArr.forEach(p => {
        let opt = document.createElement('option');
        opt.value = p; opt.innerHTML = p;
        pSelect.appendChild(opt);
    });

    // Isi otomatis dropdown Bonus 25rb - 1jt
    const bonusSelect = document.getElementById('bonusSelect');
    for(let i=25000; i<=1000000; i+=25000) {
        let opt = document.createElement('option');
        opt.value = i; opt.innerHTML = "Rp " + i.toLocaleString();
        bonusSelect.appendChild(opt);
        if(i >= 100000 && i < 1000000) i += 25000; // Percepat interval setelah 100rb jika perlu
    }

    // Script Kirim ke Google Sheets
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzZiWRHTKUFtyboUbTtpfVBVBHR_hJ79MSN5zCTg9vjXc9LwRNe0CxZFqD1H6xrq8mr/exec'; // GANTI DENGAN URL DARI LANGKAH 1
    const form = document.getElementById('salesForm');

    form.addEventListener('submit', e => {
        e.preventDefault();
        fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => {
                document.getElementById('notif').style.display = 'block';
                form.reset();
                setTimeout(() => { document.getElementById('notif').style.display = 'none'; }, 3000);
            })
            .catch(error => console.error('Error!', error.message));
    });
</script>

</body>
</html>
